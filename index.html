#include <WiFi.h>
    #include <WebServer.h>
        const char* STA_SSID = "CONECTA_SENAC"; //Rede do senac
        const char* STA_PWD = "";
        //Portas para controlar o motor A
        const int in1 = 26;
        const int in2 = 27;
        const int in3 = 14;
        const int in4 = 12;

        //Portas dos bot√µes

        const int buzina = 15;
        const int buzina2 = 2;
        const int luzesF = 33;
        const int luzesT = 32;
        const int ataqueAtk = 35;
        const int direita = 34;
        const int Esquerda = 25;

        WebServer server(80);

        String PAGINA = R"rawliteral(
        <!DOCTYPE html>
        <html lang="pt-BR">

        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Controlando o Carrinho</title>
            <style>
                * {
                    font-family: 'Courier New', Courier, monospace;
                    box-sizing: border-box;
                    margin: 0px;
                    padding: 0px;
                }

                body {
                    color: #fff;
                    background: linear-gradient(to right, #252525 0%, #bdbaba 137%);
                    padding: 10px 20px;
                    min-height: 100vh;
                    display: block;
                    flex-direction: column;
                }

                .imagem {
                    display: flex;
                    margin: 0;
                    height: 100vh;
                    transform: translateY(50px);
                    opacity: 0.5;
                    transition: transform 0.3s ease, opacity 0.3s ease;
                    border-radius: 60px;
                }

                .imagem:hover {
                    transform: translateY(0);
                    opacity: 1;
                }

                button {
                    margin: 8px;
                    border-radius: 2vw;
                    background-color: rgb(0, 0, 0);
                    color: #ffffff;
                    font-size: 30px;
                    width: 150px;
                    max-width: 220px;
                    height: 100px;
                    border: none;
                    padding: 14px 20px;
                }

                .botao {
                    background-color: #ad2c2c;
                    border-radius: 60px;
                    margin-left: -14px;
                    margin-right: -14px;
                    height: 100vh;
                    display: flex;
                    gap: 250px;
                    padding: 50px;
                    align-items: center;
                    justify-content: space-evenly;
                    background-image: url(https://i.pinimg.com/1200x/bd/c6/6d/bdc66d3a5ca6d5f9630d7ce1471f46a4.jpg);
                    background-repeat: round;
                }

                .apoio {
                    display: flex;
                    margin: -2px 370px 5 400px;
                    justify-content: space-between;

                }

                .apoio1 {
                    background-color: #252525;
                    width: 255px;
                    height: 260px;
                    border-radius: 0px 2px 70px 50px;
                }

                .apoio2 {
                    background-color: #252525;
                    width: 255px;
                    height: 260px;
                    border-radius: 2px 0px 50px 70px;
                }


                .frente {
                    display: flex;
                    justify-content: center;
                }

                .frente button {
                    background-color: rgb(0 0 0 / 70%);
                    border-radius: 40%;
                    height: 80px;
                    width: 80px;
                    box-shadow: 7px 5px 6px black;
                    border: solid 1px black;
                }

                .meio {
                    display: flex;
                    justify-content: left;
                }

                .meio button {
                    background-color: rgb(0 0 0 / 70%);
                    border-radius: 40%;
                    height: 80px;
                    width: 80px;
                    box-shadow: 7px 5px 6px black;
                    border: solid 1px black;
                }

                .re {
                    display: flex;
                    justify-content: center;
                }

                .re button {
                    background-color: rgb(0 0 0 / 70%);
                    border-radius: 40%;
                    height: 80px;
                    width: 80px;
                    box-shadow: 7px 5px 6px black;
                    border: solid 1px black;

                }

                .botao2 {
                    display: flex;
                    align-items: center;
                    justify-content: space-evenly;
                    flex-direction: column;
                }

                .atk {
                    display: flex;
                    justify-content: right;
                }

                .atk button {
                    background-color: rgb(0 0 0 / 80%);
                    border-radius: 50%;
                    height: 80px;
                    width: 80px;
                    box-shadow: 7px 5px 6px black;
                    border: solid 1px black;
                }

                .luzest {
                    display: flex;
                    justify-content: center;

                }

                .luzest button {
                    background-color: rgb(0 0 0 / 80%);
                    border-radius: 50%;
                    height: 80px;
                    width: 80px;
                    box-shadow: 7px 5px 6px black;
                    border: solid 1px black;
                }

                .luzesf {
                    display: flex;
                    justify-content: center;
                }

                .luzesf button {
                    background-color: rgb(0 0 0 / 80%);
                    border-radius: 50%;
                    height: 80px;
                    width: 80px;
                    box-shadow: 7px 5px 6px black;
                    border: solid 1px black;
                }



                @media (max-width: 1000px) {
                    * {
                        padding: 0;
                        margin: 0;
                    }

                    main {
                        margin: 20px auto;
                        padding: 0 10px;
                    }

                    .botao {
                        background: linear-gradient(#252525, #000);
                        border-radius: 60px;
                        margin: -35px -25px;
                        height: 100vh;
                        display: flex;
                        gap: 80px;
                        align-items: center;
                        justify-content: space-evenly;
                        background-image: url(https://i.pinimg.com/736x/7e/61/72/7e617230ae15f4cb117aef7595f79d0b.jpg);
                        background-repeat: round;
                    }

                }

                @media (max-width: 500px) {
                    * {
                        padding: 0;
                        margin: 0;
                    }

                    .botao {
                        background-color: #ad2c2c;
                        border-radius: 60px;
                        margin-left: -27px;
                        margin-right: -27px;
                        height: 100vh;
                        display: flex;
                        flex-direction: column;
                        gap: 40px;
                        padding: 0px;
                        align-items: center;
                        justify-content: space-evenly;
                        background-image: url(https://i.pinimg.com/1200x/bd/c6/6d/bdc66d3a5ca6d5f9630d7ce1471f46a4.jpg);
                        background-repeat: round;
                    }
                }
            </style>
            </style>
        </head>

        <body>
            <!-- <header>
        <h1>Controle do carro de corrida do Max Verstapen!<h1></h1>
    </header> -->
            <main>
                <!-- ======= BOT√ïES DIRECIONAIS ========== -->
                <section class="botao">
                    <div>
                        <div class="frente">
                            <button onclick="location.href='/dianteiro'">‚ñ≤</button>
                        </div>
                        <div class="meio">
                            <button onclick="location.href='/esquerda'">‚óÄ</button>
                            <button onclick="location.href='/parar'">‚èπÔ∏é</button>
                            <button onclick="location.href='/direita'">‚ñ∂</button>
                        </div>
                        <div class="re">
                            <button onclick="location.href='/traseiro'">‚ñº</button>
                        </div>
                    </div>
                    <!--=============== BOT√ïES DE ATAQUE ================== -->

                    <div class="botao2">
                        <div class="luzesf">
                            <button onclick="location.href='/luzesfrontais'">üí°</button>
                        </div>
                        <div class="atk">
                            <button onclick="location.href='/esquerda'">‚óÄ</button>
                            <button onclick="location.href='/buzina'">‚öîÔ∏è</button>
                            <button onclick="location.href='/direita'">‚ñ∂</button>
                        </div>
                        <div class="luzest">
                            <button onclick="location.href='/luzestraseiras'">üî¶</button>
                        </div>
                    </div>
                </section>
                </section>
            </main>
        </body>

        </html>

        )rawliteral";

        void handleRoot(){
        server.send(200, "text/html", PAGINA);
        }
        void motorDianteiro(){
        digitalWrite(in1, HIGH);
        digitalWrite(in2, LOW);
        digitalWrite(in3, HIGH);
        digitalWrite(in4, LOW);
        server.send(200, "text/html", PAGINA);
        }
        void motorTraseiro(){
        digitalWrite(in1, LOW);
        digitalWrite(in2, HIGH);
        digitalWrite(in3, LOW);
        digitalWrite(in4, HIGH);
        server.send(200, "text/html", PAGINA);
        }
        void motorParar(){
        digitalWrite(in1, LOW);
        digitalWrite(in2, LOW);
        digitalWrite(in3, LOW);
        digitalWrite(in4, LOW);
        server.send(200, "text/html", PAGINA);
        }
        void motorDireita(){
        digitalWrite(in1, LOW);
        digitalWrite(in2, HIGH);
        digitalWrite(in3,HIGH);
        digitalWrite(in4, LOW);
        server.send(200, "text/html", PAGINA);
        }
        void motorEsquerda(){
        digitalWrite(in1, HIGH);
        digitalWrite(in2, LOW);
        digitalWrite(in3, LOW);
        digitalWrite(in4, HIGH);
        server.send(200, "text/html", PAGINA);
        }
        void luzesFrontais(){
        digitalWrite(luzesF, LOW);
        digitalWrite(luzesF, HIGH);
        server.send(200, "text/html", PAGINA);
        }

        void luzesTraseiras(){
        digitalWrite(luzesT, HIGH);
        digitalWrite(luzesT, LOW);
        server.send(200, "text/html", PAGINA);
        }

        void Atk(){
        digitalWrite(ataqueAtk, HIGH);
        digitalWrite(ataqueAtk, LOW);
        server.send(200, "text/html", PAGINA);
        }

        void buz(){
        digitalWrite(buzina, HIGH);
        delay(1000);
        digitalWrite(buzina, LOW);
        server.send(200, "text/html", PAGINA);
        }

        void buz2(){
        digitalWrite(buzina2, HIGH);
        delay(1000);
        digitalWrite(buzina2, LOW);
        server.send(200, "text/html", PAGINA);
        }


        void setup() {
        Serial.begin(115200);
        delay(1000);

        IPAddress local_IP(192, 168, 27, 51);
        IPAddress gateway(192, 168, 16, 1);
        IPAddress subnet(255, 255, 240, 0);
        IPAddress dns(8, 8, 8, 8);

        WiFi.config(local_IP, gateway, subnet, dns);

        WiFi.mode(WIFI_STA);
        WiFi.begin(STA_SSID, STA_PWD);

        Serial.print("Conectando ao WiFi ");
        Serial.println(STA_SSID);

        int tentativas = 0;
        while (WiFi.status() != WL_CONNECTED && tentativas < 30) {
        delay(500);
        Serial.print(".");
        tentativas++;
     }
        if (WiFi.status() != WL_CONNECTED) {
        Serial.println("\nNAO CONECTOU AO WIFI :(");
        return; // n√£o continua se n√£o tiver WiFi
        }

         Serial.println("\nConectado!");
         Serial.print("IP do ESP32: ");
         Serial.println(WiFi.localIP());
         Serial.print("Gateway: ");
         Serial.println(WiFi.gatewayIP());
         Serial.print("Mascara: ");
         Serial.println(WiFi.subnetMask());

        Serial.println();
        Serial.println("Iniciando ESP32...");
        //configurando portas do motor A
        pinMode(in1, OUTPUT);
        pinMode(in2, OUTPUT);
        pinMode(in3, OUTPUT);
        pinMode(in4, OUTPUT);
        pinMode(buzina,OUTPUT);
        pinMode(buzina2,OUTPUT);
        pinMode(luzesF, OUTPUT);
        pinMode(luzesT, OUTPUT);
        pinMode(ataqueAtk, OUTPUT);

      
        Serial.begin(115200);
        server.on("/", handleRoot);
        server.begin();
        server.on("/dianteiro", motorDianteiro);
        server.on("/traseiro", motorTraseiro);
        server.on("/parar", motorParar);
        server.on("/direita", motorDireita);
        server.on("/esquerda", motorEsquerda);
        server.on("/luzesfrente", luzesFrontais);
        server.on("/luzestras", luzesTraseiras);
        server.on("/atk", Atk);
        server.on("/buzina", buz);
        server.on("/buzina2", buz2);
        server.begin();
        }
        void loop() {
        server.handleClient();
        }